  <!-- @if (headerVisible) {

  <div>
    <app-header [label]="'Productos'"></app-header>
  </div>
}

<nav class="navbar bg-body-tertiary">
  <div class="container-fluid">
    <div class="d-flex" role="search"> -->
      <!-- <input
        class="form-control me-2"
        type="search"
        placeholder="Buscar por nombre"
        aria-label="Search"
        [(ngModel)]="productName"
        (keydown.enter)="buscarProductos()"
      /> -->
      <!-- <div class="input-group">
        <input
        class="form-control "
        type="search"
        placeholder="Buscar por nombre"
        aria-label="Search"
        [(ngModel)]="productName"
        (keydown.enter)="buscarProductos()"
        />
        <button
        class="btn btn-outline-success"
        type="submit"
        (click)="buscarProductos()"
      >
        <app-icons-svg [nombreIcono]="'search'" />
      </button>
      </div> -->
      <!-- <button
        class="btn btn-outline-success w-50"
        type="submit"
        (click)="buscarProductos()"
      >
        <app-icons-svg [nombreIcono]="'search'" />
      </button> -->
      
      <!-- <div class="dropdown">
        <button
          class="btn btn-secondary dropdown-toggle"
          type="button"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          @if (productCategory.valueOf()) {
          {{ productCategory }}
          } @else { Filtrar por categoría }
        </button>
        <ul class="dropdown-menu" style="max-height: 110px; overflow-y: auto">
          @for (category of categoryList; track $index) {
          <li>
            <a
              class="dropdown-item"
              (click)="buscarProductosByCategory(category)"
              > {{ category.category }}</a
            >
          </li>
          }
        </ul>
      </div>


      <button type="button" class="btn btn-primary" routerLink="addProduct">
        <app-icons-svg [nombreIcono]="'add'" />
      </button>

      <button
        class="btn btn-secondary"
        (click)="submitOrder()"
        routerLink="listPedidos"
      >
        <app-icons-svg [nombreIcono]="'delivery'" />
      </button>
    </div>
  </div>
</nav>


@if (loading) {
<ng-container>
  <div class="d-flex justify-content-center h-50">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>
</ng-container>
} @if (!loading) {
<ng-container>
  @if (inventoryList.length === 0) { Lista vacia } @else {

    <div class="container-div">
    <div class="responsive-div">
      <table class="table table-striped table-hover" style="text-align: center">
        <thead>
          <tr class="table-secondary">
            <th scope="col" (click)="sortTable('product')" class="th">Producto</th>
            <th scope="col" (click)="sortTable('category')" class="th">Categoría</th>
            <th scope="col" (click)="sortTable('price')" class="th">Precio</th>
            <th scope="col" (click)="sortTable('stock')" class="th">Cantidad</th>
            <th scope="col">Seleccionar</th>
          </tr>
        </thead>
        <tbody>
          @for (product of inventoryList; track $index) {
          <tr
            [ngClass]="{
              'table-danger': product.stock <= 4,
              'table-success': product.selected
            }"
          >
            <td>{{ product.product }}</td>
            <td>{{ product.category.category }}</td>
            <td>{{ product.price | currency }}</td>
            <td>{{ product.stock }}</td>
            <td>
              <div class="d-flex">
                @if (!viewPedido) {
                  <button
                  [routerLink]="[
                    '/inventory',
                    'details',
                    product.id,
                    product.product
                  ]"
                  type="button"
                  class="btn btn-info"
                >
                  <app-icons-svg [nombreIcono]="'edit'" />
                </button>
                } @else {
                  <button class="btn btn-info" (click)="showModalEditProduct(product.id)">
                    <i class="bi bi-pencil-square"></i>
                  </button>
                }
                <button
                  (click)="deleteProduct(product.id)"
                  type="button"
                  class="btn btn-danger"
                >
                  <app-icons-svg [nombreIcono]="'delete'" />
                </button>
                <button
                  class="btn btn-success"
                  (click)="toggleConfirmation(product)"
                >
                  <app-icons-svg [nombreIcono]="'check'" />
                </button>
              </div>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
  
    }
  </ng-container>
    
} -->

<!-- Modal para editar el producto -->
<!-- <div class="modal fade" id="editarProductoModal" tabindex="-1" aria-labelledby="editarProductoModalLabel" aria-hidden="true" #editarProductoModal>
  <div class="modal-dialog  modal-dialog-centered modal-dialog-scrollable">
      <div class="modal-content">
          <div class="modal-header">
              <h5 class="modal-title" id="editarProductoModalLabel">Vender Producto</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
          </div>
          <div class="modal-body">
              <form id="editProductForm" [formGroup]="productoForm">
                  <div class="mb-3">
                      <label for="product" class="form-label">Producto</label>
                      <input type="text" class="form-control" formControlName="product" id="product">
                  </div>
                  <div class="mb-3">
                      <label for="price" class="form-label">Precio</label>
                      <input type="text" class="form-control" formControlName="price" [value]=" 0 | currency:'USD':'symbol':'1.2-2'" id="price">
                  </div>
                  <div class="mb-3">
                      <label for="stock" class="form-label">Stock Disponible</label>
                      <input type="number" class="form-control" formControlName="stock" id="stock" >
                  </div>
                  <div class="mb-3">
                      <label for="cantidad" class="form-label">Cantidad a Vender</label>
                      <input type="number" class="form-control" id="cantidad" name="cantidad" min="1" required>
                  </div>
              </form>
          </div>
          <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
              <button type="button" class="btn btn-primary" id="sellProductBtn">Vender</button>
          </div>
      </div>
  </div>
</div> -->

<div class="container">
  <h3>Productos Inventario</h3>
  <div class="row">
    <div class="col-md-6">
      <div class="input-group">
        <button class="input-group-text" (click)="buscarProductos()" id="basic-addon1"><i class="bi bi-search"></i></button>
        <input type="text" [(ngModel)]="productName" (keydown.enter)="buscarProductos()" class="form-control" placeholder="Buscar por nombre o código" aria-label="Username" aria-describedby="basic-addon1">
      </div>
    </div>
    <div class="col-md-3">
      <div class="input-group">
        <span class="input-group-text" id="basic-addon1"><i class="bi bi-funnel"></i></span>
        <select class="form-select" aria-label="Filtrar por Categoría" (change)="buscarProductosByCategory($event.target?.value)">
          <option selected>Filtrar por Categoría</option>
          @for (categoria of categoryList; track $index) {
          <option value="{{categoria.id}}" >{{categoria.category}}</option>
          }
        </select>
      </div>
    </div>
    <div class="col-md-3">
      <button class="btn bg-black text-light fw-medium" data-bs-toggle="modal" data-bs-target="#agregarProducto"> <i class="bi bi-plus"></i> Agregar Producto</button>
  </div>
  <div class="row">
    <table class="table">
      <thead>
        <tr>
          <td class="text-body-secondary" scope="col">Codigo</td>
          <td class="text-body-secondary" scope="col">Nombre</td>
          <td class="text-body-secondary" scope="col">Categoria</td>
          <td class="text-body-secondary" scope="col">Cantidad</td>
          <td class="text-body-secondary" scope="col">Precio Unitario</td>
          <td class="text-body-secondary" scope="col">Acciones</td>
        </tr>
      </thead>
      <tbody>
        @for (product of inventoryList; track $index) {
        <tr>
          <td>{{product.id}}</td>
          <td>{{product.product}}</td>
          <td>{{product.category.category}}</td>
          <td>{{product.stock}}</td>
          <td>{{product.price | currency}}</td>
          <td>
            <div class="dropdown">
              <button class="btn btn-light" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                <i class="bi bi-three-dots-vertical"></i>
              </button>
              <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                <li><a class="dropdown-item" href="#">Editar</a></li>
                <li><a class="dropdown-item" href="#">Eliminar</a></li>
              </ul>
            </div>
          </td>
        </tr>
        }
      </tbody>
    </table>
    
  </div>
  </div>


<!-- Modal -->
<div class="modal fade" id="agregarProducto" tabindex="-1" aria-labelledby="agregarProducto" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <div class="d-flex flex-column justify-content-start align-items-start">          
          <h1 class="modal-title fs-5" id="agregarProducto">Agregar Producto</h1>
          <small>Ingrese los detalles del nuevo producto a continuación.</small>
        </div>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="d-flex mb-3">
            <div class="d-flex justify-content-end w-25">
              <label for="product" class="form-label text-black fw-medium">Nombre</label>
            </div>
            <input type="text" class="form-control w-75" id="Nombre" placeholder="Producto">
          </div>
          <div class="d-flex mb-3">
            <div class="d-flex justify-content-end w-25">
              <label for="category" class="form-label text-black fw-medium">Categoria</label>
            </div>
            <div class="input-group w-75">
              <input type="text" class="form-control" placeholder="Categoria" aria-label="Categoria" aria-describedby="basic-addon1">
              <button class="input-group-text btn btn-secondary" id="basic-addon1"><i class="bi bi-tags"></i></button>
            </div>
          </div>
          <div class="d-flex mb-3">
            <div class="d-flex justify-content-end w-25">
              <label for="price" class="form-label text-black fw-medium">Precio Unitario</label>
            </div>
            <input type="text" class="form-control w-75" id="price" placeholder="Precio">
          </div>
          <div class="d-flex mb-3">
            <div class="d-flex justify-content-end w-25">
              <label class="text-black fw-medium">Cantidad</label>
            </div>
            <input type="number" minlength="0" class="form-control w-75" id="cantidad" placeholder="Cantidad">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn bg-black text-light fw-medium w-100">Save changes</button>
      </div>
    </div>
  </div>
</div>